"use strict";
var _a, _HazelCastStore_store;
Object.defineProperty(exports, "__esModule", { value: true });
exports.HazelCastStore = void 0;
const tslib_1 = require("tslib");
const common_1 = require("@heronjs/common");
const cache_manager_1 = tslib_1.__importDefault(require("cache-manager"));
class HazelCastStore {
    constructor(store) {
        this.store = store;
        _HazelCastStore_store.set(this, void 0);
        this.get = () => {
            return this.store;
        };
        tslib_1.__classPrivateFieldSet(this, _HazelCastStore_store, store, "f");
    }
}
exports.HazelCastStore = HazelCastStore;
_a = HazelCastStore, _HazelCastStore_store = new WeakMap();
HazelCastStore.create = async (config) => {
    const hazelCastStore = await Promise.resolve().then(() => tslib_1.__importStar(require('cache-manager-hazelcast')));
    const { host, port, ttl, prefix, defaultMap, cacheValueValidator } = config;
    const cache = cache_manager_1.default.caching({
        store: hazelCastStore,
        host,
        port,
        prefix,
        defaultMap,
        ttl,
        isCacheableValue: cacheValueValidator || common_1.isCacheableValue
    });
    return new HazelCastStore(cache);
};
